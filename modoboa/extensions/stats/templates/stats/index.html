{% extends "twocols.html" %}{% load i18n %}{% load url from future %}
{% block pagetitle %}{% trans "Graphical statistics" %}{% endblock %}
{% block html_head %}
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}stats/css/stats.css" />
<script type="text/javascript" src="{{ STATIC_URL }}js/history.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/autocompleter.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/d3.v3.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}stats/js/d3.legend.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}stats/js/graphic.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}stats/js/stats.js"></script>
<script type="text/javascript">
function get_domains_list(container) {
    $.getJSON("{% url 'modoboa.extensions.admin.views.domain.domains_list' %}", function(data) {
        container.value = data;
    });
}

$(document).ready(function() {
    var stats = new Stats({
        graphurl: "{% url 'modoboa.extensions.stats.views.graphs' %}",
        deflocation: "{{ deflocation|safe }}",
        language: "{{ LANGUAGE_CODE }}"
    });
});
</script>
{% endblock %}
{% block leftcol %}
<div id="periods" class="well sidebar-nav">
  <ul class="nav nav-list">
      <div class="side-bar-responsive">
            <li class="nav-header">
              {% trans "Filter" %}
            </li>
            <li>
              <div class="input-group">
                <span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>
                <input class="col-lg-10 form-control" id="searchquery" type="text" value="{% trans 'Search a domain' %}">
              </div>
            </li>
            <li class="nav-header">
              {% trans "Predefined time ranges" %}
            </li>
            {% for p in periods %}<li class="period">
              <a href="#" class="period_selector" data-period="{{ p.name }}">{% trans p.label %}</a>
            </li>
            {% endfor %}
            <li class="nav-header">
              {% trans "Custom time range" %}
            </li>
            <li>
              <form class="form-horizontal">
                <span id="custom-period">
                  <div class="input-group input-group-sm">
                    <div class="input-group-addon"><i class="glyphicon glyphicon-indent-left"></i></div>
                    <input id="id_from" class="col-lg-10 form-control" name="date_from" value="{{ start }}" type="text" readonly="readonly" />
                  </div>
                  <div class="input-group input-group-sm">
                    <div class="input-group-addon"><i class="glyphicon glyphicon-indent-right"></i></div>
                    <input id="id_to" class="col-lg-10 form-control" name="date_to" value="{{ end }}" type="text" readonly="readonly" />
                  </div>
                  <button class="btn btn-primary" id="customsend">{% trans "Apply" %}</button>
                </span>
              </form>
            </li>
        </div>
      </ul>
    </div>
    {% endblock %}
    {% block apparea %}
    <div id="graphs" class="tabbable">
      <ul class="nav nav-tabs">{% for id, gset in graph_sets.items %}
        <li {% if forloop.first %}class="active"{% endif %}>
          <a href="#graphs_{{ gset.html_id }}" data-toggle="tab">{{ gset.title }}</a>
        </li>
  </ul>{% endfor %}
  <div class="tab-content">{% for id, gset in graph_sets.items %}
    <div class="tab-pane {% if forloop.first %}active{% endif %}" id="graphs_{{ gset.html_id }}">
      <div id="gset"></div>
    </div>
  </div>{% endfor %}
</div>
{% endblock %}
 
